<html xmlns:t="http://tapestry.apache.org/schema/tapestry_5_0_0.xsd">
<head>
    <title>Job Analytics - Ping Service</title>
    <link rel="stylesheet" type="text/css" href="/css/all.css" />
	<link rel="icon" type="image/png" href="/favicon.png" /> 
    <link rel="stylesheet" type="text/css" href="/assets/anjlab/cubics/css/cube.css" />
    <link rel="stylesheet" type="text/css" href="/css/analytics.css" />
    <script type="text/javascript" src="/assets/anjlab/cubics/js/jquery-1.3.2.js"></script>
    <script type="text/javascript" src="/assets/anjlab/cubics/js/cube.js"></script>
    <!--[if IE]><script language="javascript" type="text/javascript" src="excanvas.min.js"></script><![endif]--> 
    <script type="text/javascript" src="/js/jquery.flot.js"></script>
    <script type="text/javascript" src="/js/jquery.flot.pie.js"></script>
    <script type="text/javascript" src="/js/analytics.js"></script>
</head>
<body>
	<t:topbar/>
	
   	<h2>Analytics Workspace</h2>
   	
   	<p>for ${job.titleFriendly} (statistics based on data from ${dateFrom} to ${dateTo})</p>
   	
   	<font color="red"><p>${message}</p></font>

	<p>
	<t:form>
		View: <t:select t:id="view" model="viewModel" value="view"/>
		<t:submit value="Show" />
		&#160;
		<a href="javascript:collapseAll();">Collapse All</a>&#160;
		<a href="javascript:collapseOne();">&#xAB; Less</a>&#160;
		<a href="javascript:expandOne();">More &#xBB;</a>&#160;
		<a href="javascript:expandAll();">Expand All</a>
	</t:form>
	</p>
   	
   	<table>
	   	<tr valign="top">
		   	<td>
				<p>
					<a href="/feedback?subject=Request for custom View">Need more views? Send a request (it's free)</a>
				</p>
		   		<t:outputraw value="cubeHTML" />
				<p>   	
			 	    Download raw data in 
					<t:actionlink t:id="exportCSV">CSV</t:actionlink>
					for analysis.
				</p>
		   	</td>
		   	<td align="center" style="padding-left: 50px;">
		   		<p align="right">
		   			<a href="javascript:plotSummaryCharts();">Plot Summary Charts</a>
		   		</p>
		   		<div style="width: 400px; height: 200px;" id="chart"/>
		   		<div style="width: 400px; height: 200px; display: hidden;" id="chart2"/>
		   		<div style="width: 400px; height: 200px; display: hidden;" id="chart3"/>
		   	</td>
	   	</tr>
   	</table>
   	
   	
   	<script type="text/javascript">
   		collapseAll();
   		
   		function hideSummaryCharts() {
   			$("#chart2").hide();
   			$("#chart3").hide();
   		}
   		
   		function showSummaryCharts() {
   			$("#chart2").show();
   			$("#chart3").show();
   		}
   		
   		function plotSummaryCharts() {
   			showSummaryCharts();
   		
   			var pies = $(".m-7");
   			plotPieChart($($(pies.get(pies.length-1)).children().get(0)), "#chart");
   			plotLineChart($($(".m-0").get(0)), "#chart2");
   			var histograms = $(".m-4");
   			plotHistogramChart($($(histograms.get(histograms.length-1)).children().get(0)), "#chart3");
   		}
   		
   		plotSummaryCharts();
   	</script>
   	
	<t:footer/>
</body>
</html>
